/* ===== Base ===== */
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #f3f3f3; /* colore iniziale richiesto */
  color: #f3f3f3;
  font-family: "Roboto", sans-serif;
  overflow: hidden;
}

/* ===== Layer a pieno schermo (NOTA: #end-image NON è full-screen) ===== */
#viewer-container,
#noise-canvas,
#replacement-video,
#vignette {
  position: absolute;
  inset: 0;         /* top/right/bottom/left:0 */
  width: 100vw;
  height: 100vh;
}

#viewer-container { z-index: 0; }

/* ===== model-viewer ===== */
model-viewer {
  width: 100%;
  height: 100%;
  object-fit: contain;

  /* Transizioni solo su opacity/filter: il transform è pilotato da JS (shake fluido) */
  transition: opacity .25s ease, filter .25s ease;
  opacity: 1;
  filter: none;
  transform: none;
}

/* Nascondi UI/loader/hint di model-viewer */
model-viewer::part(default-progress-bar) { display: none; }
model-viewer::part(default-ar-button)     { display: none; }
model-viewer::part(announcement)          { display: none; }

/* ===== Canvas rumore (sopra al modello e sotto al video) ===== */
#noise-canvas {
  z-index: 1;
  pointer-events: none;
  opacity: 0;
  transition: opacity .15s linear;
}

/* ===== Video full-screen ===== */
#replacement-video {
  z-index: 2;
  display: none;           /* mostrato da JS */
  pointer-events: none;    /* non intercetta input */
  object-fit: cover;       /* copre tutto */
  background: #000;
  opacity: 0;
  transition: opacity .3s ease;
}

/* Vignetta sopra il video */
#vignette {
  z-index: 3;
  pointer-events: none;
  background: radial-gradient(ellipse at center, transparent 60%, rgba(0,0,0,.5) 100%);
  opacity: 0;
  transition: opacity .3s ease;
}

/* ===== Immagine pillola finale (più piccola) ===== */
#end-image {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%); /* centrata */
  display: none;                     /* nascosta all’avvio */
  width: clamp(56px, 12vmin, 120px);
  height: auto;
  max-width: 70vw;
  max-height: 70vh;
  cursor: pointer;
  z-index: 4;
  transition: transform .2s ease, filter .2s ease;
  filter: drop-shadow(0 10px 30px rgba(0,0,0,.5));
}
#end-image:hover {
  transform: translate(-50%, calc(-50% - 6px)); /* hover più delicato */
  filter: drop-shadow(0 16px 40px rgba(0,0,0,.55));
}

/* ===== Tooltip minimal ef.link ===== */
#tooltip {
  position: absolute;
  display: none;
  padding: 0;
  background: none;
  color: #0000ee;
  border: none;
  font-family: "Roboto", sans-serif;
  font-size: 0.9rem;
  white-space: nowrap;
  text-decoration-line: underline;
  z-index: 5;
  opacity: 0;
  transition: opacity .3s ease;
  pointer-events: none;
}
#tooltip span { display: inline-block; }

/* 2_Prova per scritta "Image-Conflict" */

/*-------------- CANCELLA da qui: pill-label wave -----------------*/
#pill-label{
  /* manopole regolabili */
  --offset: 18vmin;      /* distanza verticale sotto la pillola */
  --wave-dur: 2.4s;      /* durata dell'onda (più alto = più lenta) */
  --stagger: 90ms;       /* ritardo tra lettere (più alto = più separate in ingresso) */
  --rise: 38px;          /* da quanto “salgono” dal basso in ingresso */
  --letter-space: .18em; /* distanza orizzontale tra lettere */

  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, calc(-50% + var(--offset)));
  z-index: 4;
  pointer-events: none;
  opacity: 0;                   /* nascosto finché non si hovera la pillola */
  transition: opacity .35s ease;
  white-space: nowrap;
}

/* stile del testo + spaziatura orizzontale */
#pill-label .wave{
  color: #ffffff;
  font-family: "Roboto", sans-serif;
  font-weight: 100;
  font-size: clamp(10px, 2.3vmin, 26px);
  letter-spacing: var(--letter-space);
  /* rimuoviamo il vecchio clip-path: l'ingresso ora è per-lettera */
}

/* ogni lettera: parte invisibile e più in basso; onda in pausa finché non c'è hover */
#pill-label .wave span{
  display: inline-block;
  opacity: 0;
  transform: translateY(var(--rise));
  /* ingresso dolce: sale e compare, con ritardo a cascata */
  transition:
    transform .7s cubic-bezier(.22,1,.36,1),
    opacity   .7s ease;
  transition-delay: calc(var(--i) * var(--stagger));

  /* anima l'onda (verticale) ma rimane in pausa finché non si hovera */
  animation: wave var(--wave-dur) ease-in-out infinite;
  animation-delay: calc(400ms + var(--i) * (var(--stagger) + 30ms));
  animation-play-state: paused;
}

/* quando si hovera la pillola: mostra il caption e avvia le lettere */
#end-image:hover ~ #pill-label{ opacity: 1; }
#end-image:hover ~ #pill-label .wave span{
  opacity: 1;
  transform: translateY(0);
  animation-play-state: running;
}

/* onda più morbida */
@keyframes wave{
  0%,100% { transform: translateY(0); }
  50%     { transform: translateY(-6px); }
}

/*-------------- CANCELLA fin a qui: pill-label wave -----------------*/


/* === Scheda a 3 colonne in basso (selezionabile) === */
#pill-info{
  position: absolute;
  left: clamp(12px, 3.5vmin, 28px);
  right: clamp(12px, 3.5vmin, 28px);
  bottom: clamp(12px, 3.5vmin, 28px);

  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr)); /* <-- 3 colonne */
  gap: clamp(10px, 2.2vmin, 24px);

  color: #eaeaea00;
  font-size: clamp(11px, 1.35vmin, 14px);
  line-height: 1.45;
  letter-spacing: .01em;

  z-index: 5;
  opacity: 0;                    /* appare solo quando richiesto */
  transform: translateY(8px);
  transition: opacity .4s ease, transform .4s ease;

  user-select: text;
  -webkit-user-select: text;
  pointer-events: auto;
}

/* Stato visibile */
#pill-info.show{
  opacity: 1;
  transform: translateY(0);
}

/* Stili di base interni */
#pill-info p{ margin: 0 0 .8em 0; }
#pill-info ul.tight{
  margin: .1em 0 .8em 1.1em;
  padding: 0;
}

/* Responsive: 2 colonne su tablet, 1 su mobile */
@media (max-width: 1100px){
  #pill-info{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
}
@media (max-width: 640px){
  #pill-info{ grid-template-columns: 1fr; }
}
